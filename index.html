<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–µ–π—Å—ã –∑–∞ ‚≠ê ‚Äî Mini App</title>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://telegram.org/js/telegram-web-app.js" crossorigin="anonymous"></script>

  <style>
    :root{
      /* brand tokens */
      --bg-dark:#0a0b0c; --bg-card:#0b0f14; --border:#272a2e;
      --text:#ffffff; --muted:#8e9492; --orange:#ff7a1a;
      --blue:#7bb5ff; --purple:#b68aff;
      --radius-xl:16px; --shadow-lg:0 16px 34px rgba(0,0,0,.42);
      --ease:cubic-bezier(.2,.8,.2,1);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; color:var(--text); font-family:'Manrope',system-ui,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(1100px 700px at 15% -10%, #14181e 0%, transparent 60%),
        radial-gradient(900px 600px at 115% 0%, #191a1f 0%, transparent 55%),
        linear-gradient(180deg,#0b0d10 0%, #090a0c 100%);
    }
    a{color:inherit;text-decoration:none}

    .container{max-width:960px;margin:0 auto;padding:20px 16px 96px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:12px}

    @keyframes fadeInUp{from{opacity:0;transform:translateY(10px) scale(.98);}to{opacity:1;transform:translateY(0) scale(1);}}
    .fade{animation:fadeInUp .38s var(--ease) both}

    /* header */
    .title{font-size:32px;font-weight:800;letter-spacing:-.01em;margin:0}
    .pill{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(180deg,#ff8a2a,#ff7a1a);
      color:#111;border-radius:18px;padding:10px 14px;font-weight:800;box-shadow:0 10px 26px rgba(255,122,26,.28)}

    /* feed */
    .feed{display:flex;gap:12px;overflow-x:auto;padding:10px 2px 2px;margin-top:12px}
    .feed::-webkit-scrollbar{display:none}
    .feed-item{min-width:280px;border:1px solid var(--border);background:linear-gradient(135deg,#14171b,#0d0f12);
      border-radius:14px;padding:10px 12px;display:flex;align-items:center;justify-content:space-between}
    .feed-text{display:flex;align-items:center;gap:10px;min-width:0}
    .feed-time{font-size:12px;color:var(--muted)}
    .emoji{font-size:20px}

    /* grid */
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px;margin-top:14px}
    @media (min-width:820px){ .grid{grid-template-columns:repeat(4,minmax(0,1fr))} }

    /* case card */
    .card{background:var(--bg-card);border:1px solid var(--border);border-radius:20px;padding:16px;
      box-shadow:var(--shadow-lg);transition:transform .18s var(--ease), filter .18s var(--ease);cursor:pointer}
    .card:hover{transform:translateY(-4px);filter:brightness(1.04)}
    .fan{position:relative;height:74px;display:flex;align-items:flex-end;justify-content:center}
    .mini{width:58px;height:74px;border-radius:12px;background:#111418;border:1px solid var(--border);
      display:flex;align-items:center;justify-content:center;box-shadow:0 12px 28px rgba(0,0,0,.35)}
    .mini.glow-blue{box-shadow:0 0 0 2px rgba(123,181,255,.55) inset,0 12px 26px rgba(0,0,0,.35)}
    .mini.glow-purple{box-shadow:0 0 0 2px rgba(182,138,255,.55) inset,0 12px 26px rgba(0,0,0,.35)}
    .mini.glow-orange{box-shadow:0 0 0 2px rgba(255,122,26,.7) inset,0 12px 26px rgba(0,0,0,.35)}
    .mini:nth-child(1){transform:translateX(-16px) rotate(-14deg) scale(.98)}
    .mini:nth-child(2){transform:translateX(0) rotate(0) scale(1.06);z-index:2;margin-left:-24px}
    .mini:nth-child(3){transform:translateX(16px) rotate(14deg) scale(.98);margin-left:-24px}

    .card-title{font-size:18px;font-weight:800;text-align:center;margin:12px 0 4px}
    .card-sub{font-size:12px;color:var(--muted);text-align:center;margin:0}
    .meta{font-size:12px;color:var(--muted);text-align:center;margin-top:8px}

    /* detail: flip cards */
    .detail-head{display:flex;align-items:center;gap:8px;margin:6px 0 12px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:none;cursor:pointer}
    .btn-primary{background:linear-gradient(180deg,#ff8a2a,#ff7a1a);color:#111;border-radius:18px;padding:10px 14px;font-weight:800;
      box-shadow:0 8px 24px rgba(255,122,26,.28)}
    .btn-secondary{background:#101317;color:#e4e4e7;border:1px solid var(--border);border-radius:16px;padding:8px 12px;font-weight:700}

    .hand{position:relative;height:clamp(150px,44vw,176px);display:flex;justify-content:center;align-items:flex-end;pointer-events:none;margin-top:8px}
    .hand-card{position:relative;pointer-events:auto;margin-left:-36px;transition:transform .35s var(--ease),filter .2s,opacity .2s}
    .hand-card:first-child{margin-left:0}
    .flip{width:clamp(96px,28vw,118px);height:clamp(128px,36vw,156px);position:relative;transform-style:preserve-3d;transition:transform 700ms var(--ease);
      border-radius:16px;box-shadow:var(--shadow-lg)}
    .flip.flipped{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;border-radius:16px;backface-visibility:hidden;display:flex;align-items:center;justify-content:center;border:1px solid var(--border)}
    .front{background:linear-gradient(135deg,#151920,#0f1216);color:#eaeef2}
    .back{background:#0f1114;transform:rotateY(180deg)}
    .rar-chip{margin-top:6px;display:inline-block;padding:2px 6px;border-radius:999px;font-size:10px;background:var(--muted);color:#111}
    .glow-b-blue{box-shadow:0 0 0 2px rgba(123,181,255,.55),0 0 20px rgba(123,181,255,.28)}
    .glow-b-purple{box-shadow:0 0 0 2px rgba(182,138,255,.60),0 0 22px rgba(182,138,255,.30)}
    .glow-b-orange{box-shadow:0 0 0 2px rgba(255,122,26,.70),0 0 24px rgba(255,122,26,.35)}

    .result{margin-top:12px;display:flex;align-items:center;justify-content:space-between;gap:10px;border:1px solid var(--border);
      background:var(--bg-card);border-radius:16px;padding:10px 12px}

    /* tabbar */
    .tabbar{position:fixed;left:0;right:0;bottom:0;padding:12px 16px;background:rgba(0,0,0,.72);backdrop-filter:blur(8px);
      border-top:1px solid var(--border);z-index:5}
    .tabs{max-width:960px;margin:0 auto;display:flex;gap:12px}
    .tab{flex:1 1 0;display:flex;flex-direction:column;align-items:center;gap:4px;background:#0f1216;border:1px solid var(--border);
      border-radius:14px;padding:10px 6px;font-weight:800;transition:filter .15s var(--ease), transform .12s var(--ease), border-color .25s var(--ease)}
    .tab:active{transform:scale(.96)}
    .tab.active{border-color:rgba(255,122,26,.65);box-shadow:0 0 0 2px rgba(255,122,26,.28) inset}
    .tab small{font-size:12px;color:#cdd0d4}

    @media (max-width:390px){ .hand{height:150px} .hand-card{margin-left:-30px} }
  </style>
</head>
<body>
  <main class="container" id="app"></main>

  <nav class="tabbar">
    <div class="tabs">
      <a href="#" class="tab active" data-tab="profile"><div>üë§</div><small>–ü—Ä–æ—Ñ–∏–ª—å</small></a>
      <a href="#" class="tab" data-tab="voting"><div>üó≥Ô∏è</div><small>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</small></a>
      <a href="#" class="tab" data-tab="inventory"><div>üéí</div><small>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</small></a>
    </div>
  </nav>

  <script>
    // ===== Mini helpers =====
    const tg = window.Telegram?.WebApp;
    try{ tg?.ready?.(); tg?.expand?.(); }catch(_){}

    const qs = (sel, root=document) => root.querySelector(sel);
    const el = (tag, cls, html) => { const n=document.createElement(tag); if(cls) n.className=cls; if(html!=null) n.innerHTML=html; return n; };

    // ===== Demo data =====
    const START_STARS = 25;
    const CASES = [
      { id:'lite', title:'–õ–∞–π—Ç-–∫–µ–π—Å', price:3, sub:'–î–µ—à—ë–≤—ã–π –≤—Ö–æ–¥',
        prizes:[{id:'l1',label:'–°—Ç–∏–∫–µ—Ä –º–∏–Ω–∏',emoji:'üêæ',rarity:'common',weight:55},
                {id:'l2',label:'1‚≠ê –Ω–∞–∑–∞–¥',emoji:'‚≠ê',rarity:'common',weight:30,stars:1},
                {id:'l4',label:'5‚≠ê –¥–∂–µ–∫–ø–æ—Ç',emoji:'üí•',rarity:'epic',weight:3,stars:5}]},
      { id:'starter', title:'–°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–µ–π—Å', price:6, sub:'–î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤',
        prizes:[{id:'s1',label:'–°—Ç–∏–∫–µ—Ä-–ø–∞–∫',emoji:'üò∫',rarity:'common',weight:45},
                {id:'s3',label:'–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –±–µ–π–¥–∂',emoji:'üèÖ',rarity:'rare',weight:17},
                {id:'s5',label:'–ú–µ–≥–∞–ø—Ä–∏–∑: 20‚≠ê',emoji:'üí´',rarity:'legendary',weight:2,stars:20}]},
      { id:'pro', title:'–ü—Ä–æ-–∫–µ–π—Å', price:12, sub:'–ë–æ–ª—å—à–æ–π —Ä–∏—Å–∫',
        prizes:[{id:'p2',label:'–°–∫–∏–Ω',emoji:'üé®',rarity:'rare',weight:28},
                {id:'p4',label:'10‚≠ê –Ω–∞–∑–∞–¥',emoji:'üåü',rarity:'epic',weight:15,stars:10},
                {id:'p5',label:'60‚≠ê –¥–∂–µ–∫–ø–æ—Ç',emoji:'üèÜ',rarity:'legendary',weight:5,stars:60}]},
      { id:'ultra', title:'–£–ª—å—Ç—Ä–∞-–∫–µ–π—Å', price:30, sub:'–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–µ –Ω–∞–≥—Ä–∞–¥—ã',
        prizes:[{id:'u2',label:'–†–µ–¥–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç',emoji:'üßø',rarity:'epic',weight:28},
                {id:'u4',label:'120‚≠ê',emoji:'üèÜ',rarity:'legendary',weight:6,stars:120},
                {id:'u6',label:'300‚≠ê',emoji:'ü¶Ñ',rarity:'legendary',weight:2,stars:300}]},
    ];
    const SELL = { common:1, rare:2, epic:6, legendary:20 };
    const rarityOrder = {legendary:4,epic:3,rare:2,common:1};

    const top3 = (arr) => arr.slice().sort((a,b)=>{
      const ra=rarityOrder[a.rarity]||0, rb=rarityOrder[b.rarity]||0;
      if(rb!==ra) return rb-ra;
      const sa=a.stars||0, sb=b.stars||0; if(sb!==sa) return sb-sa;
      return (a.weight||0)-(b.weight||0);
    }).slice(0,3);

    const glowMiniClass = r => ({common:'glow-blue',rare:'glow-purple',epic:'glow-orange',legendary:'glow-orange'}[r]||'glow-blue');

    // ===== State =====
    let stars = START_STARS;
    let selected = null; // case id
    const feed = [];

    // simulate global feed
    (function seedFeed(){
      const users=['@max','@ivan','@lena','@art','@kira','@john','@mike'];
      const all=CASES.flatMap(c=>c.prizes);
      for(let i=0;i<4;i++){
        const p=all[Math.floor(Math.random()*all.length)];
        const u=users[Math.floor(Math.random()*users.length)];
        feed.push({user:u,emoji:p.emoji||'üéÅ',label:p.label||'–ü—Ä–∏–∑',time:ts()});
      }
      setInterval(()=>{
        const p=all[Math.floor(Math.random()*all.length)];
        const u=users[Math.floor(Math.random()*users.length)];
        feed.push({user:u,emoji:p.emoji||'üéÅ',label:p.label||'–ü—Ä–∏–∑',time:ts()});
        render();
      }, 6500+Math.random()*1500);
    })();

    const ts = () => new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});

    // ===== Audio =====
    class SpinAudio{
      constructor(){this.ctx=null;this.gain=null;}
      ensure(){if(!this.ctx){const AC=window.AudioContext||window.webkitAudioContext;if(!AC)return;this.ctx=new AC();this.gain=this.ctx.createGain();this.gain.gain.value=0.06;this.gain.connect(this.ctx.destination);}}
      flip(){this.ensure();if(!this.ctx||!this.gain)return;const o=this.ctx.createOscillator(),g=this.ctx.createGain();o.type='triangle';o.frequency.value=520;o.connect(g).connect(this.gain);const t=this.ctx.currentTime;g.gain.setValueAtTime(0.05,t);g.gain.exponentialRampToValueAtTime(0.00001,t+0.15);o.start(t);o.stop(t+0.16);}
      win(){this.ensure();if(!this.ctx||!this.gain)return;const o=this.ctx.createOscillator(),g=this.ctx.createGain();o.type='sine';o.frequency.value=880;o.connect(g).connect(this.gain);const t=this.ctx.currentTime;g.gain.setValueAtTime(0.08,t);g.gain.exponentialRampToValueAtTime(0.00001,t+0.4);o.frequency.exponentialRampToValueAtTime(1320,t+0.35);o.start(t);o.stop(t+0.4);}
    }
    const audio = new SpinAudio();

    // ===== Views =====
    function render(){
      const root = qs('#app'); root.innerHTML = '';
      // header
      const header = el('div','row fade');
      header.innerHTML = `<h1 class="title">${selected? '–û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞' : '–ö–µ–π—Å—ã –∑–∞ ‚≠ê'}</h1>
                          <div class="pill"><span id="stars">${stars}</span><span>‚≠ê</span></div>`;
      root.appendChild(header);

      // live feed
      root.appendChild(renderFeed());

      // content
      if(!selected) root.appendChild(renderHome());
      else root.appendChild(renderDetail(selected));

      // footer
      const foot = el('div','fade'); foot.style.marginTop='16px';
      foot.style.textAlign='center'; foot.style.color='var(--muted)'; foot.style.fontSize='12px';
      foot.innerHTML = `–î–µ–º–æ—Ä–µ–∂–∏–º. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∏–∑ —á–µ—Ä–µ–∑ <b style="color:#fff">/api/open</b>.`;
      root.appendChild(foot);
    }

    function renderFeed(){
      const wrap = el('section','feed fade');
      feed.slice(-20).forEach(e=>{
        const it = el('div','feed-item');
        it.innerHTML = `
          <div class="feed-text">
            <div class="emoji">${e.emoji}</div>
            <div class="txt"><span style="color:var(--muted)">${e.user}</span>&nbsp;–ø–æ–ª—É—á–∏–ª&nbsp;<b>${e.label}</b></div>
          </div>
          <div class="feed-time">${e.time}</div>`;
        wrap.appendChild(it);
      });
      setTimeout(()=>{wrap.scrollLeft = wrap.scrollWidth},0);
      return wrap;
    }

    function renderHome(){
      const grid = el('section','grid fade');
      CASES.forEach(c=>{
        const card = el('article','card');
        const picks = top3(c.prizes);
        card.innerHTML = `
          <div class="fan">
            ${picks.map(p=>`<div class="mini ${glowMiniClass(p.rarity)}"><span>${p.emoji||'üéÅ'}</span></div>`).join('')}
          </div>
          <h3 class="card-title">${c.title}</h3>
          <p class="card-sub">${c.sub}</p>
          <div class="meta">–¶–µ–Ω–∞: <b style="color:#fff">${c.price} ‚≠ê</b></div>`;
        card.addEventListener('click',()=>{ selected=c.id; window.scrollTo({top:0,behavior:'smooth'}); render(); });
        grid.appendChild(card);
      });
      return grid;
    }

    function renderDetail(caseId){
      const data = CASES.find(x=>x.id===caseId);
      const wrap = el('section','fade');

      const head = el('div','detail-head');
      head.innerHTML = `<button class="btn btn-secondary" id="back">‚Üê –ù–∞–∑–∞–¥</button>
                        <div style="font-size:18px;font-weight:800">${data.title}</div>
                        <div style="margin-left:auto;font-size:13px;color:var(--muted)">–¶–µ–Ω–∞: ${data.price} ‚≠ê</div>`;
      wrap.appendChild(head);
      qs('#back', head).onclick = ()=>{ selected=null; render(); };

      const hint = el('div'); hint.style.color='var(--muted)'; hint.style.fontSize='14px';
      hint.textContent = '–ù–∞–∂–º–∏ ¬´–û—Ç–∫—Ä—ã—Ç—å¬ª, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å';
      wrap.appendChild(hint);

      const hand = el('div','hand'); wrap.appendChild(hand);
      const cards = Array.from({length:5},()=>({el:null}));
      for(let i=0;i<5;i++){
        const holder = el('div','hand-card');
        const f = el('div','flip');
        f.innerHTML = `<div class="face front"><div style="font-size:32px">?</div></div>
                       <div class="face back"><div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center">
                         <div style="font-size:34px" class="p-emoji">üéÅ</div>
                         <div style="margin-top:6px;font-size:13px;font-weight:700" class="p-label">–ü—Ä–∏–∑</div>
                         <div class="rar-chip p-rar">rarity</div>
                       </div></div>`;
        holder.appendChild(f);
        hand.appendChild(holder);
        cards[i].el = holder;
      }

      const baseTransform=(i,n)=>{
        const narrow = window.innerWidth <= 414;
        const spread = narrow?18:24, start=-spread/2;
        const angle = start + i * (spread / Math.max(1, n-1));
        const y = Math.abs(i - (n-1)/2) * (narrow?2:3);
        return {angle,y};
      };
      const placeIdle = ()=>{
        cards.forEach((c,i)=>{
          const {angle,y}=baseTransform(i,cards.length);
          c.el.style.transform = `rotate(${angle}deg) translateY(${y}px)`;
          c.el.style.zIndex = 5;
        });
      };
      const placeRevealed=(picked)=>{
        const narrow = window.innerWidth <= 414;
        cards.forEach((c,i)=>{
          const {angle,y}=baseTransform(i,cards.length);
          if(i===picked){ c.el.style.transform=`rotate(${angle}deg) translateY(${Math.max(0,y-(narrow?1:2))}px) scale(${narrow?1.03:1.06})`; c.el.style.zIndex=50; return; }
          const dir=i<picked?-1:1, distance=(narrow?56:90)+Math.abs(i-picked)*(narrow?8:12), lift=narrow?6:10, ang=angle*(narrow?0.9:0.8);
          c.el.style.transform=`rotate(${ang}deg) translate(${dir*distance}px, ${y+lift}px) scale(${narrow?0.965:0.96})`;
          c.el.style.zIndex = 5-Math.abs(i-picked);
        });
      };

      placeIdle();

      let opening = false, pickedIndex=null, landedPrize=null;

      const weightedPick = (arr)=>{
        const total = arr.reduce((s,p)=>s+(p.weight||0),0) || 1;
        let r = Math.random()*total;
        for(const p of arr){ r -= (p.weight||0); if(r<=0) return p; }
        return arr[arr.length-1];
      };

      function startOpen(){
        if(opening) return;
        if(stars < data.price){ toast('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚≠ê'); tg?.HapticFeedback?.notificationOccurred?.('warning'); return; }
        opening = true; stars -= data.price; updateStars();
        tg?.HapticFeedback?.impactOccurred?.('medium');
        hint.textContent = '–í—ã–±–µ—Ä–∏ –æ–¥–Ω—É –∫–∞—Ä—Ç—É';
      }

      function flipPick(i){
        if(!opening || pickedIndex!==null) return;
        pickedIndex = i;

        let prize = weightedPick(data.prizes);

        // flip chosen
        audio.flip(); tg?.HapticFeedback?.selectionChanged?.();
        const holder = cards[i].el.querySelector('.flip');
        holder.classList.add('flipped');
        fillPrize(holder, prize);
        holder.classList.add(prize.rarity==='legendary'?'glow-b-orange':prize.rarity==='epic'?'glow-b-purple':prize.rarity==='rare'?'glow-b-blue':'');

        landedPrize = prize;
        placeRevealed(i);
        setTimeout(()=>{ // reveal rest
          cards.forEach((c,idx)=>{
            if(idx===i) return;
            const alt = weightedPick(data.prizes);
            const f = c.el.querySelector('.flip');
            f.classList.add('flipped'); fillPrize(f, alt);
          });
          audio.win(); tg?.HapticFeedback?.impactOccurred?.('heavy');
          hint.textContent = '–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç';
          renderResult();
        }, 400);
      }

      function fillPrize(f, prize){
        f.querySelector('.p-emoji').textContent = prize.emoji || 'üéÅ';
        f.querySelector('.p-label').textContent = prize.label || '–ü—Ä–∏–∑';
        f.querySelector('.p-rar').textContent = prize.rarity || 'rare';
      }

      const actions = el('div'); actions.style.marginTop='12px';
      actions.innerHTML = `<button class="btn btn-primary" id="open">–û—Ç–∫—Ä—ã—Ç—å –∑–∞ ${data.price} ‚≠ê</button>`;
      wrap.appendChild(actions);
      qs('#open',actions).onclick = ()=>{ startOpen(); };

      cards.forEach((c,i)=> c.el.addEventListener('click',()=> flipPick(i)));

      function renderResult(){
        const box = el('div','result');
        box.innerHTML = `
          <div style="display:flex;align-items:center;gap:8px">
            <div style="font-size:22px">${landedPrize.emoji||'üéÅ'}</div>
            <div style="font-size:14px">
              <div style="font-weight:800">${landedPrize.label}</div>
              <div class="rar-chip">${landedPrize.rarity}</div>
            </div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-secondary" id="sell">–ü—Ä–æ–¥–∞—Ç—å –∑–∞ ${(SELL[landedPrize.rarity]||1)} ‚≠ê</button>
            <button class="btn btn-primary" id="claim">–ó–∞–±—Ä–∞—Ç—å</button>
          </div>`;
        wrap.appendChild(box);

        qs('#sell',box).onclick = ()=>{
          const v = SELL[landedPrize.rarity]||1; stars += v; updateStars(); toast(`–ü—Ä–æ–¥–∞–Ω–æ: +${v} ‚≠ê`);
          selected=null; render();
        };
        qs('#claim',box).onclick = ()=>{
          if(landedPrize.stars) { stars += landedPrize.stars; updateStars(); }
          pushFeed(landedPrize,'@you'); toast('–ü—Ä–µ–¥–º–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω');
          selected=null; render();
        };
      }

      return wrap;
    }

    function updateStars(){ const s=qs('#stars'); if(s) s.textContent = stars; }
    function pushFeed(prize,user){
      feed.push({user:user||'@you',emoji:prize.emoji||'üéÅ',label:prize.label||'–ü—Ä–∏–∑',time:ts()});
    }

    function toast(text){
      let t = qs('#toast'); if(t) t.remove();
      t = el('div'); t.id='toast';
      t.style.position='fixed'; t.style.left='50%'; t.style.bottom='88px'; t.style.transform='translateX(-50%)';
      t.style.background='var(--orange)'; t.style.color='#111'; t.style.padding='8px 12px'; t.style.borderRadius='12px';
      t.style.boxShadow='0 8px 24px rgba(255,122,26,.25)'; t.style.fontWeight='800'; t.style.zIndex='9';
      t.textContent=text; document.body.appendChild(t); setTimeout(()=>t.remove(),1800);
    }

    document.querySelectorAll('.tab').forEach(t=>{
      t.addEventListener('click',e=>{e.preventDefault();document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));t.classList.add('active');});
    });

    render();
  </script>
</body>
</html>
