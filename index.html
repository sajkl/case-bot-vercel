<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ö–µ–π—Å—ã –∑–∞ ‚≠ê ‚Äî Telegram Mini App</title>

  <!-- libs -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={darkMode:'class',theme:{extend:{}}};</script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">

  <!-- error catcher -->
  <script>
    (function(){
      const show=(title,detail)=>{
        try{const box=document.getElementById('err');
        if(box){box.style.display='block';box.textContent=`${title}\n${detail||''}`;}}catch(_){}
      };
      window.onerror=(m,src,line,col,err)=>{
        show(`JS error: ${m}`,[`source: ${src||'-'}`,`line: ${line||'-'}, col: ${col||'-'}`,`stack: ${(err&&err.stack)||'-'}`].join('\n'));
      };
      window.addEventListener('unhandledrejection',e=>{
        show('Promise error',(e.reason&&e.reason.stack)||String(e.reason));
      });
    })();
  </script>

  <style>
    :root{
      --black:#0A0B0C;
      --white:#FFFFFF;
      --nardo:#8E9492;
      --orange:#FF7A1A;
      --border:#272a2e;
    }
    html,body,#root{height:100%;}
    body{
      background:linear-gradient(180deg,#0b0d10 0%, #090a0c 100%);
      color:var(--white);
      font-family:'Manrope',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    @keyframes fadeInUp{from{opacity:0;transform:translateY(10px) scale(.98);}to{opacity:1;transform:translateY(0) scale(1);}}
    .fade-in{animation:fadeInUp .38s cubic-bezier(.2,.8,.2,1) both;}
    .mini-fan{position:relative;height:70px;display:flex;align-items:flex-end;justify-content:center;}
    .mini-card{width:58px;height:74px;border-radius:12px;background:#111418;border:1px solid var(--border);
      display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 12px 28px rgba(0,0,0,.35);}
    .glow-common{box-shadow:0 0 0 2px rgba(142,148,146,.45) inset,0 12px 26px rgba(0,0,0,.35);}
    .glow-rare{box-shadow:0 0 0 2px rgba(120,180,255,.55) inset,0 12px 26px rgba(0,0,0,.35);}
    .glow-epic{box-shadow:0 0 0 2px rgba(180,120,255,.55) inset,0 12px 26px rgba(0,0,0,.35);}
    .glow-legendary{box-shadow:0 0 0 2px rgba(255,122,26,.70) inset,0 12px 26px rgba(0,0,0,.35);}
    .cases-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:1rem;}
    .hfeed-wrap{margin-top:10px;margin-bottom:12px;}
    .hfeed{display:flex;gap:10px;overflow-x:auto;-webkit-overflow-scrolling:touch;padding-bottom:2px;}
    .hfeed::-webkit-scrollbar{display:none;}
    .hfeed-item{min-width:220px;border-radius:14px;border:1px solid var(--border);
      background:linear-gradient(135deg,#14171b,#0d0f12);padding:10px 12px;
      display:flex;align-items:center;justify-content:space-between;}
  </style>
</head>
<body>
  <div id="root"></div>
  <pre id="err" style="display:none;position:fixed;left:8px;bottom:64px;right:8px;max-height:40vh;overflow:auto;background:#111;color:#fff;padding:8px;border-radius:8px;z-index:9999"></pre>

  <script type="text/babel">
    const {useState,useEffect,useRef} = React;

    const START_STARS=25;
    const DEFAULT_CASES=[/* —Ç–≤–æ–∏ –∫–µ–π—Å—ã –∫–∞–∫ —Ä–∞–Ω—å—à–µ */ 
      {id:'lite',title:'–õ–∞–π—Ç-–∫–µ–π—Å',priceStars:3,description:'–î–µ—à—ë–≤—ã–π –≤—Ö–æ–¥',
        prizes:[{emoji:'‚≠ê',rarity:'common'},{emoji:'üí•',rarity:'epic'},{emoji:'üöÄ',rarity:'legendary'}]},
      {id:'starter',title:'–°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–µ–π—Å',priceStars:6,description:'–î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤',
        prizes:[{emoji:'üò∫',rarity:'common'},{emoji:'üèÖ',rarity:'rare'},{emoji:'üí´',rarity:'legendary'}]},
      {id:'pro',title:'–ü—Ä–æ-–∫–µ–π—Å',priceStars:12,description:'–ë–æ–ª—å—à–æ–π —Ä–∏—Å–∫',
        prizes:[{emoji:'üåü',rarity:'rare'},{emoji:'üé®',rarity:'epic'},{emoji:'üèÜ',rarity:'legendary'}]},
      {id:'ultra',title:'–£–ª—å—Ç—Ä–∞-–∫–µ–π—Å',priceStars:30,description:'–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–µ –Ω–∞–≥—Ä–∞–¥—ã',
        prizes:[{emoji:'üßø',rarity:'epic'},{emoji:'üèÜ',rarity:'legendary'},{emoji:'ü¶Ñ',rarity:'legendary'}]}
    ];

    const glowMini=(r)=>({common:'glow-common',rare:'glow-rare',epic:'glow-epic',legendary:'glow-legendary'}[r]||'');

    const MiniCards=({prizes})=>{
      const picks=prizes.slice(0,3);
      const fan=[{rot:-14,x:-16,z:10,s:0.98,ml:0},{rot:0,x:0,z:30,s:1.06,ml:-24},{rot:14,x:16,z:20,s:0.98,ml:-24}];
      return(
        <div className="mini-fan">
          {picks.map((p,i)=>(
            <div key={i} className={`mini-card ${glowMini(p.rarity)}`}
              style={{transform:`translateX(${fan[i].x}px) rotate(${fan[i].rot}deg) scale(${fan[i].s})`,
                      zIndex:fan[i].z,marginLeft:i===0?0:fan[i].ml}}>
              {p.emoji}
            </div>
          ))}
        </div>
      );
    };

    const HomeCaseCard=({c,onClick})=>(
      <div onClick={onClick} role="button" className="rounded-2xl p-4 border transition cursor-pointer fade-in"
        style={{background:'#0b0f14',borderColor:'var(--border)'}}>
        <MiniCards prizes={c.prizes}/>
        <div className="mt-3 flex flex-col items-center justify-center text-center fade-in">
          <div className="text-base font-extrabold">{c.title}</div>
          <div className="text-xs" style={{color:'var(--nardo)'}}>{c.description}</div>
          <div className="mt-2 text-xs" style={{color:'var(--nardo)'}}>–¶–µ–Ω–∞: <span style={{color:'#fff'}}>{c.priceStars} ‚≠ê</span></div>
        </div>
      </div>
    );

    const LiveFeed=({events})=>{
      const listRef=useRef();
      useEffect(()=>{if(listRef.current){listRef.current.scrollLeft=listRef.current.scrollWidth;}},[events]);
      return(
        <div className="hfeed-wrap">
          <div className="hfeed" ref={listRef}>
            {events.map((e,i)=>(
              <div key={i} className="hfeed-item">
                <span>{e.user} –≤—ã–±–∏–ª {e.emoji} {e.label}</span>
                <span className="text-xs text-gray-400">{e.time}</span>
              </div>
            ))}
          </div>
        </div>
      );
    };

    function App(){
      const [cases]=useState(DEFAULT_CASES);
      const [stars,setStars]=useState(START_STARS);
      const [events,setEvents]=useState([]);

      const onClaimPrize=(p)=>{
        const ev={user:'–ò–≥—Ä–æ–∫',emoji:p.emoji,label:p.label||'–ü—Ä–∏–∑',time:new Date().toLocaleTimeString()};
        setEvents(evs=>[...evs,ev]);
      };

      return(
        <div className="min-h-dvh pb-20 px-4 py-5">
          <div className="mx-auto max-w-md">
            <header className="flex items-center justify-between fade-in" style={{animationDelay:'20ms'}}>
              <h1 className="text-2xl font-bold tracking-tight">–ö–µ–π—Å—ã –∑–∞ ‚≠ê</h1>
              <div className="px-3 py-2 rounded-xl bg-orange-500 text-black font-semibold shadow-lg">{stars} ‚≠ê</div>
            </header>
            <LiveFeed events={events}/>
            <section className="mt-3 cases-grid">
              {cases.map(c=><HomeCaseCard key={c.id} c={c} onClick={()=>onClaimPrize(c.prizes[0])}/>)}
            </section>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>
